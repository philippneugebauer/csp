#!/usr/bin/env bash
set -euo pipefail

printf "\n[1/3] RuboCop\n"
RUBOCOP_CACHE_ROOT=tmp/rubocop_cache bin/rubocop --no-server

printf "\n[2/3] Brakeman\n"
bundle exec brakeman --quiet --no-pager --exit-on-warn --exit-on-error

printf "\n[3/3] Bundler audit\n"
mkdir -p tmp/ruby-advisory-db
bundle exec bundler-audit check --config config/bundler-audit.yml --database tmp/ruby-advisory-db --update

printf "\nStatic analysis completed successfully.\n"
